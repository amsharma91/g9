!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.g9=t():e.g9=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(3)},function(e,t){"use strict";function r(e,t,r){return Math.min(Math.max(e,t),r)}function n(e,t,r){var n,i,o,u,s=function(e){r(o+e.clientX-n,u+e.clientY-i)},c=function l(e){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)};e.addEventListener("mousedown",function(e){e.preventDefault(),n=e.clientX,i=e.clientY;var r=t(e),l=a(r,2);o=l[0],u=l[1],o=o||0,u=u||0,document.addEventListener("mousemove",s),document.addEventListener("mouseup",c)})}function i(e,t){e&&Object.keys(e).forEach(function(r){return t(e[r],r)})}function o(e,t){var r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];i(t,function(t,n){e.setAttributeNS(r,n,t)})}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(s){i=!0,o=s}finally{try{!n&&u["return"]&&u["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.clamp=r,t.makeDraggable=n,t.forIn=i,t.setAttributes=o;t.defaultBounds={xmin:-(1/0),xmax:1/0,ymin:-(1/0),ymax:1/0}},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(e){var t=e.type,r=e.renderer,n=e.base,i=e.options,o=e.shortcut,a=e.cost;y[t]={renderer:r,base:n,shortcut:o,options:i,cost:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.addshape=i;var o=r(7),a=n(o),u=r(9),s=n(u),c=r(10),l=n(c),f=r(8),h=n(f),y={};i(a),i(s),i(l),i(h),t["default"]=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(5),a=n(o),u=r(6),s=n(u),c=r(4),l=n(c),f=r(2),h=n(f);e.exports=function(e,t){function r(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;t>o;o++)r[o-1]=arguments[o];var a=c[e],u=a.type,s=Object.keys(y);a.cares&&(s=a.cares);var f=s.map(function(e){return y[e]}),d=(0,l["default"])(function(t){var n,o=i({},y);s.forEach(function(e,r){o[e]=t[r]});var c=v(o,a.stack),l=c[e],f=(n=h["default"][u]).cost.apply(n,[l].concat(r));return f},f).solution;s.forEach(function(e,t){y[e]=d[t]}),n()}function n(){c=v(y),d.render(c),f(y,c)}function o(){return d}function u(e){y=e,n()}var c,f=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2],y=e,d=new s["default"](r),v=(0,a["default"])(t);return n(),{getRenderer:o,setData:u,desire:r}}},function(e,t){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e,t){var n=t.length,i=e(t);if(isNaN(i))throw new Error("The gradient at ["+t.join(" ")+"] is NaN!");for(var o=Math.max,a=Math.abs,u=Math.min,s=[].concat(r(t)),c=Array(n),l=0;n>l;l++)for(var f=o(1e-6*i,1e-8),h=0;;h++){if(20==h)throw new Error("Gradient failed at index "+l+" of ["+t.join(" ")+"]");s[l]=t[l]+f;var y=e(s);s[l]=t[l]-f;var d=e(s);if(s[l]=t[l],!isNaN(y)&&!isNaN(d)){c[l]=(y-d)/(2*f);var v=t[l]-f,p=t[l],m=t[l]+f,b=(y-i)/f,x=(i-d)/f,g=u(o(a(b-c[l]),a(x-c[l]),a(b-x)),f),w=o(a(c[l]),a(y),a(i),a(d),a(v),a(p),a(m),1e-8);if(.001>g/w)break}f/=16}return c}function i(e){return Math.sqrt(e.reduce(function(e,t){return e+t*t},0))}function o(e){return Array.from(Array(e),function(t,r){return Array.from(Array(e),function(e,t){return+(r==t)})})}function a(e){return e.map(function(e){return-e})}function u(e,t){return Array.isArray(e[0])?e.map(function(e){return u(e,t)}):e.reduce(function(e,r,n){return e+r*t[n]},0)}function s(e,t){return Array.isArray(e[0])?e.map(function(e,r){return s(e,t[r])}):e.map(function(e,r){return e-t[r]})}function c(e,t){return Array.isArray(e[0])?e.map(function(e,r){return c(e,t[r])}):e.map(function(e,r){return e+t[r]})}function l(e,t){return e.map(function(e){return e.map(function(e){return e/t})})}function f(e,t){return Array.isArray(e[0])?e.map(function(e){return f(e,t)}):e.map(function(e){return e*t})}function h(e,t){return e.map(function(e,r){return f(t,e)})}function y(e,t){var y=arguments.length<=2||void 0===arguments[2]?1e-8:arguments[2],d=arguments.length<=3||void 0===arguments[3]?1e3:arguments[3];y=Math.max(y,2e-16),t=[].concat(r(t));var v=t.length,p=e(t);if(isNaN(p))throw new Error("minimize: f(x0) is a NaN!");for(var m=function(t){return n(e,t)},b=o(v),x=m(t),g=0;d>g;g++){if(!x.every(isFinite)){var w="Gradient has Infinity or NaN";break}var j=a(u(b,x));if(!j.every(isFinite)){var w="Search direction has Infinity or NaN";break}var k=i(j);if(y>k){var w="Newton step smaller than tol";break}for(var A,O=1,N=u(x,j),P=t;d>g&&O*k>=y;g++){A=f(j,O),P=c(t,A);var _=e(P);if(!(_-p>=.1*O*N||isNaN(_)))break;O*=.5}if(y>O*k){var w="Line search step size smaller than tol";break}if(g===d){var w="maxit reached during line search";break}var E=m(P),M=s(E,x),C=u(M,A),S=u(b,M);b=s(c(b,f(h(A,A),(C+u(M,S))/(C*C))),l(c(h(S,A),h(A,S)),C)),t=P,p=_,x=E}return{solution:t,f:p,gradient:x,invHessian:b,iterations:g,message:w}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(t){function r(){return"auto"+h+l++}function n(e){return function(){if(f[f.length-1]++,null===i||(i+"|").startsWith(f.join("|"))){f.push(0);var t=l;l=0,h=f.join("|");var r=e.apply(this,arguments);f.pop(),l=t,h=f.join("|")}return r}}var i=arguments.length<=1||void 0===arguments[1]?null:arguments[1],u={},l=0,f=[0],h=f.join("|"),y={pure:n};return(0,c.forIn)(s["default"],function(e,t){y[t]=function(){for(var t=a({},e.base),n=[].concat(Array.prototype.slice.call(arguments)),i=0;i<n.length-1;i++)t[e.shortcut[i]]=n[i];if("object"===o(n[i])){var s=a({},n[i]);e.options.forEach(function(e){e in s&&(t[e]=s[e],delete s[e])}),t.attributes=s}else t[e.shortcut[i]]=n[i];t.id=r(),t.stack=f.join("|"),u[t.id]=t}}),e(t,y),u}}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t["default"]=i;var u=r(2),s=n(u),c=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),u=n(a),s=r(1),c=function(){function e(t){i(this,e),this.elements={},this.el=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.align={x:"left",y:"top"},this.desire=t,window.addEventListener("resize",this.resize.bind(this))}return o(e,[{key:"xAlign",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"left":arguments[0];return this.align.x=e,this.resize(),this}},{key:"yAlign",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"top":arguments[0];return this.align.y=e,this.resize(),this}},{key:"resize",value:function(){var e=this.align,t=e.x,r=e.y,n=this.el.getBoundingClientRect(),i=n.width,o=n.height;if("left"===t)var a=0;else if("center"===t)var a=-i/2;else var a=-i;if("top"===r)var u=0;else if("center"===r)var u=-o/2;else var u=-o;this.el.setAttribute("viewBox",[a,u,i,o].join(" "))}},{key:"render",value:function(e){var t=this.elements,r=this.desire,n=this.el;(0,s.forIn)(e,function(e,i){t[i]||(t[i]=new u["default"][e.type].renderer(i,n,r)),t[i].render(e)}),(0,s.forIn)(t,function(r,n){n in e||(r.remove(),delete t[n])}),this.resize()}},{key:"insertInto",value:function(e){return"string"==typeof e?document.querySelector(e).appendChild(this.el):e.appendChild(this.el),this.resize(),this}}]),e}();t["default"]=c},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="circle",t.base=a({type:"circle"},u.defaultBounds),t.options=["x","y","xmin","xmax","ymin","ymax","cares"],t.shortcut=["x","y"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","circle"),(0,u.setAttributes)(this.el,{r:5,fill:"#000"}),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{cx:(0,u.clamp)(e.x,e.xmin,e.xmax),cy:(0,u.clamp)(e.y,e.ymin,e.ymax)})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="image",t.base=a({type:"image"},u.defaultBounds),t.options=["href","x","y","width","height","xmin","xmax","ymin","ymax","cares"],t.shortcut=["href","x","y","width","height"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","image"),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{href:c.href},"http://www.w3.org/1999/xlink"),(0,u.setAttributes)(this.el,{x:(0,u.clamp)(e.x-e.width/2,e.xmin,e.xmax),y:(0,u.clamp)(e.y-e.height/2,e.ymin,e.ymax),width:e.width,height:e.height})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r,n){var i=e.x1,o=e.y1,a=e.x2,u=e.y2,s=i+(a-i)*t-r,c=o+(u-o)*t-n;return s*s+c*c}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.base=t.shortcut=t.options=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="line",t.options=["x1","y1","x2","y2","cares","xmin","xmax","ymin","ymax"],t.shortcut=["x1","y1","x2","y2"],t.base=a({type:"line"},u.defaultBounds),t.renderer=function(){function e(t,r,i){var o=this;n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","line"),(0,u.setAttributes)(this.el,{stroke:"#000"}),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.startDrag.bind(this),function(e,r){return i(t,o.r,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"startDrag",value:function(e){var t=this.renderable,r=t.x1,n=t.y1,i=t.x2,o=t.y2,a=i-r,u=o-n,s=this.el.getBoundingClientRect(),c=s.left,l=s.top,f=e.clientX,h=e.clientY,y=f-c+Math.min(r,i)-r,d=h-l+Math.min(n,o)-n;return this.r=Math.sqrt(y*y+d*d)/Math.sqrt(a*a+u*u),[r+a*this.r,n+a*this.r]}},{key:"render",value:function(e){this.renderable=e;var t=e.x1,r=e.y1,n=e.x2,i=e.y2,o=e.xmin,a=e.xmax,s=e.ymin,c=e.ymax,l=e.attributes;(0,u.setAttributes)(this.el,l),(0,u.setAttributes)(this.el,{x1:(0,u.clamp)(t,o,a),y1:(0,u.clamp)(r,s,c),x2:(0,u.clamp)(n,o,a),y2:(0,u.clamp)(i,s,c)})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="text",t.base=a({type:"text"},u.defaultBounds),t.options=["text","x","y","xmin","xmax","ymin","ymax","cares"],t.shortcut=["text","x","y"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","text"),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{cx:(0,u.clamp)(e.x,e.xmin,e.xmax),cy:(0,u.clamp)(e.y,e.ymin,e.ymax)}),this.el.innerText=e.text}}]),e}()}])});